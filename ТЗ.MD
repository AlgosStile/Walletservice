## Техническое задание

Необходимо создать сервис, который управляет кредитными/дебетовыми транзакциями от имени игроков.

### Описание

Денежный счет содержит текущий баланс игрока. Баланс можно изменить, зарегистрировав транзакции на счете, либо дебетовые транзакции (удаление средств), либо кредитные транзакции (добавление средств). Создайте реализацию, которая соответствует описанным ниже требованиям и ограничениям.

### Требования (06.10.2023)

* Данные хранятся в памяти приложений
* Приложение должно быть консольным (только `java-core` и `collections`)
* Регистрация игрока
* Авторизация игрока
* Текущий баланс игрока
* Дебет/снятие средств для каждого игрока. Дебетовая транзакция будет успешной только в том случае, если на счету достаточно средств (баланс - сумма дебета >= 0). Вызывающая сторона предоставит идентификатор транзакции, который должен быть уникальным для всех транзакций. Если идентификатор транзакции не уникален, операция должна завершиться ошибкой.
* Кредит на игрока. Вызывающая сторона предоставит идентификатор транзакции, который должен быть уникальным для всех транзакций. Если идентификатор транзакции не уникален, операция должна завершиться ошибкой.
* Просмотр истории пополнения/снятия средств игроком
* Аудит действий игрока (авторизация, завершение работы, пополнения, снятия и т.д.)

### Тесты

Unit-тестирование



### Обновленные требования (13.10.2023):

* Репозитории теперь должны писать ВСЕ сущности в БД PostgreSQL
* Идентификаторы при сохранении в БД должны выдаваться через sequence
* DDL-скрипты на создание таблиц и скрипты на предзаполнение таблиц должны выполняться только инструментом миграции Liquibase
* Скрипты миграции Liquibase должны быть написаны только в нотации XML
* Скриптов миграции должно быть несколько. Как минимум, один на создание всех таблиц, другой - на предзаполнение данными
* Служебные таблицы должны быть в отдельной схеме
* Таблицы сущностей запрещено хранить в схеме public
* В тестах необходимо использовать test-containers
* В приложении должен быть `docker-compose.yml`, в котором должны быть прописаны инструкции для развертывания PostgreSQL в Docker. Логин, пароль и база данных должны отличаться от тех, что прописаны в образе по умолчанию. Приложение должно работать с БД, развернутой в Docker с указанными параметрами.
* Приложение должно поддерживать конфигурационные файлы. Все, что относится к подключению к БД, а также к миграциям, должно быть сконфигурировано через конфигурационные файлы.



### Обновленные требования (20.10.2023):

* Все взаимодействие должно теперь осуществляться через отправку HTTP запросов
* Сервлеты должны принимать JSON и возвращать также JSON
* Использовать понятное именование эндпоинтов
* Возвращать разные статус-коды
* Добавить DTO (если ранее не было заложено)
* Для маппинга сущностей в DTO использовать MapStruct
* Реализовать валидацию входящих DTO
* Аудит переделать на аспекты
* Также реализовать на аспектах выполнение любого метода (с замером времени выполнения)
* Сервлеты должны быть покрыты тестами
* Метод логина должен выдавать JWT, остальные методы должны быть авторизационными и валидировать JWT



### Обновленные требования (27.10.2023):

* Java-конфигурация приложения
* Заменить кастомные конфигурационные файлы на `application.yml`
* Удалить сервлеты, реализовать Rest-контроллеры (Spring MVC)
* Использовать Swagger + Swagger UI
* Переписать аспекты на Spring AOP
* Внедрение зависимостей ТОЛЬКО через конструктор
* Удалить всю логику создания сервисов, репозиториев и т.д. Приложение должно полностью управляться Spring'ом
* Добавить тесты на контроллеры (WebMVC)



### Обновленные требования (03.11.2023):

* Использовать Spring Boot 3.2.2 с использованием необходимых стартеров
* Обновить тесты
* Вынести аспекты аудита и логирования в стартер, сделать отдельным модулем. Один стартер должен автоматически подключаться, второй через аннотацию `@EnableXXX`
* Заменить Swagger на SpringDoc